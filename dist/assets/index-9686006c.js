import{Q as f,d as Y,r as c,u as Z,c as q,R as ee,e as i,o as A,f as te,m as u,g as e,w as a,j as r,S as ae,v as le,n as oe,F as ne,E as U,U as se,p as ie,k as de,_ as re}from"./index-3887b05b.js";import{U as ce}from"./index-512a4c83.js";const ue=s=>f.post("/Listening.Admin/Category/Add",s),pe=(s,w)=>f.put(`/Listening.Admin/Category/Update/${s}`,w),me=s=>f.delete(`/Listening.Admin/Category/DeleteById/${s}`),_e=s=>f.get(`/Listening.Admin/Category/FindById/${s}`),fe=()=>f.get("/Listening.Admin/Category/FindAll"),L=s=>(ie("data-v-93a5d1e7"),s=s(),de(),s),ge={class:"listentype_container"},ve={class:"card-header"},ye=L(()=>u("span",null,"分类管理",-1)),he={class:"type-table"},be={class:"type-pagenation"},Ce={class:"type_modal"},we=L(()=>u("div",{class:"el-upload__tip"}," jpg/png files with a size less than 500kb ",-1)),Ue={class:"dialog-footer"},Ve=Y({__name:"index",setup(s){const w=c(0),E=c(10),z=c(1);let B=Z();const m=c(!1),g=c("添加"),V=c([]),n=q({english:"",chinese:"",type:[],resource:"",desc:"",currentId:"",coverUrl:"",path:""}),v=q({name:{english:"",chinese:""},coverUrl:"",path:""}),k=c();ee(async()=>{await y()});const y=async()=>{let t=await fe();V.value=t},D=async t=>{z.value=t,await y()},F=async()=>{v.name.english=n.english,v.name.chinese=n.chinese;let t=g.value;t=="修改"?await pe(n.currentId,v):await ue(v),U({type:"success",message:`${t}完成`}),m.value=!1,await y()},N=async t=>{m.value=!0,g.value="修改";let l=await _e(t.id);n.english=l.name.english,n.chinese=l.name.chinese,n.currentId=t.id},M=async t=>{se.confirm("Are you sure to close this dialog?").then(async()=>{await me(t.id),U({type:"success",message:"删除完成"}),await y()}).catch(()=>{})},S=async t=>{B.push({path:"/listenadmin/album",query:{id:t.id}})},T=t=>t.name.chinese,j=t=>t.name.english,P=t=>t.lastModificationTime==null?"暂无修改":t.lastModificationTime,_=c([{name:"examp.jpeg",url:"https://fuss10.elemecdn.com/3/63/4e7f3a15429bfda99bce42a18cdd1jpeg.jpeg?imageMogr2/thumbnail/360x360/format/webp/quality/100"}]),R=(t,l)=>{console.log(t,l)},H=t=>{console.log(t)},Q=async t=>{console.log(t);const l=new FormData;if(_.value.length>1){const d=_.value[_.value.length-1];l.append("file",d.raw);const h=await ce(l);n.coverUrl=h.url}else U({type:"error",message:"请选择封面"})},G=async t=>{t.stopPropagation(),k.value.submit()};return(t,l)=>{const d=i("el-button"),h=i("el-row"),x=i("el-card"),$=i("el-col"),J=i("el-image"),p=i("el-table-column"),K=i("el-table"),b=i("el-input"),C=i("el-form-item"),O=i("el-upload"),W=i("el-form"),X=i("el-dialog");return A(),te(ne,null,[u("div",ge,[e(h,null,{default:a(()=>[e($,{span:24},{default:a(()=>[e(x,{class:"button-card"},{header:a(()=>[u("div",ve,[ye,e(h,{class:"mb-4"},{default:a(()=>[e(d,{type:"primary",onClick:l[0]||(l[0]=o=>(g.value="添加",m.value=!0))},{default:a(()=>[r("添加")]),_:1}),e(d,{type:"primary"},{default:a(()=>[r("排序")]),_:1})]),_:1})])]),_:1})]),_:1}),e($,{span:24},{default:a(()=>[e(x,{class:"table-card"},{default:a(()=>[u("div",he,[e(K,{data:V.value,style:{width:"100%"}},{default:a(()=>[e(p,{type:"index",label:"封面",width:"150px"},{default:a(({row:o})=>[e(J,{src:o.coverUrl,fit:"cover"},null,8,["src"])]),_:1}),e(p,{prop:"path",label:"path"}),e(p,{prop:"name",label:"中文标题",formatter:T}),e(p,{prop:"name",label:"英文标题",formatter:j}),e(p,{prop:"creationTime",label:"创建时间"}),e(p,{prop:"lastModificationTime",label:"最近修改时间",formatter:P}),e(p,{label:"操作",align:"right"},{default:a(o=>[e(d,{size:"small",onClick:I=>N(o.row)},{default:a(()=>[r("修改")]),_:2},1032,["onClick"]),e(d,{size:"small",type:"danger",onClick:I=>M(o.row)},{default:a(()=>[r("删除")]),_:2},1032,["onClick"]),e(d,{size:"small",type:"primary",onClick:I=>S(o.row)},{default:a(()=>[r("管理专辑")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),u("div",be,[e(ae,{total:w.value,"page-size":E.value,onChange:D},null,8,["total","page-size"])])]),_:1})]),_:1})]),_:1})]),u("div",Ce,[e(X,{modelValue:m.value,"onUpdate:modelValue":l[7]||(l[7]=o=>m.value=o),title:g.value},{footer:a(()=>[u("span",Ue,[e(d,{onClick:l[6]||(l[6]=o=>m.value=!1)},{default:a(()=>[r("取消")]),_:1}),e(d,{type:"primary",onClick:F},{default:a(()=>[r(" 确认 ")]),_:1})])]),default:a(()=>[e(W,{model:n},{default:a(()=>[e(C,{label:"英文标题"},{default:a(()=>[e(b,{modelValue:n.english,"onUpdate:modelValue":l[1]||(l[1]=o=>n.english=o),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(C,{label:"中文标题"},{default:a(()=>[e(b,{modelValue:n.chinese,"onUpdate:modelValue":l[2]||(l[2]=o=>n.chinese=o),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(C,{label:"coverUrl"},{default:a(()=>[e(b,{modelValue:n.coverUrl,"onUpdate:modelValue":l[3]||(l[3]=o=>n.coverUrl=o),autocomplete:"off",disabled:"",placeholder:"封面上传后自动生成"},null,8,["modelValue"])]),_:1}),e(C,{label:"页面路径"},{default:a(()=>[e(b,{modelValue:n.path,"onUpdate:modelValue":l[4]||(l[4]=o=>n.path=o),autocomplete:"off",placeholder:"/path"},null,8,["modelValue"])]),_:1}),e(O,{"file-list":_.value,"onUpdate:fileList":l[5]||(l[5]=o=>_.value=o),class:"upload-demo",action:"#","http-request":Q,ref_key:"uploadRef",ref:k,"on-preview":H,"on-remove":R,"auto-upload":!1,"list-type":"picture"},{tip:a(()=>[we]),default:a(()=>[e(d,{type:"primary"},{default:a(()=>[r("选择上传图片")]),_:1}),_.value.length>1?(A(),le(d,{key:0,type:"Success",onClick:G},{default:a(()=>[r("点击上传")]),_:1})):oe("",!0)]),_:1},8,["file-list"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])],64)}}});const $e=re(Ve,[["__scopeId","data-v-93a5d1e7"]]);export{$e as default};
